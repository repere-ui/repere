/* Repere - Anchor Positioning Styles */

/* Base popover anchor positioning */
[data-repere-popover] {
  position: absolute;
  position-anchor: var(--repere-anchor);
  inset: unset;
  margin: 0;

  /* Exit state - where the popover animates TO when closing */
  opacity: var(--repere-exit-opacity, 0);
  transform: translateX(var(--repere-exit-x, 0))
    translateY(var(--repere-exit-y, -20px)) scale(var(--repere-exit-scale, 1));

  /* Enable transitions */
  transition-property: opacity, transform, overlay, display;
  transition-duration: var(--repere-transition-duration, 0.3s);
  transition-timing-function: var(
    --repere-transition-timing,
    cubic-bezier(0.4, 0, 0.2, 1)
  );
  transition-behavior: allow-discrete;
}

[data-repere-popover]:popover-open {
  /* Animate state - fully open */
  opacity: var(--repere-animate-opacity, 1);
  transform: translateX(var(--repere-animate-x, 0))
    translateY(var(--repere-animate-y, 0)) scale(var(--repere-animate-scale, 1));
}

@starting-style {
  [data-repere-popover]:popover-open {
    /* Initial state - where the animation starts FROM when opening */
    opacity: var(--repere-initial-opacity, 0);
    transform: translateX(var(--repere-initial-x, 0))
      translateY(var(--repere-initial-y, -20px))
      scale(var(--repere-initial-scale, 1));
  }
}

/* Bottom positions */
[data-repere-popover][data-position="bottom-left"] {
  top: anchor(bottom);
  left: anchor(left);
  position-try-fallbacks: --bottom-right, --top-left, --top-right;
}

[data-repere-popover][data-position="bottom-center"] {
  top: anchor(bottom);
  left: anchor(center);
  translate: -50% 0;
  position-try-fallbacks: --bottom-left, --bottom-right, --top-center;
}

[data-repere-popover][data-position="bottom-right"] {
  top: anchor(bottom);
  right: anchor(right);
  position-try-fallbacks: --bottom-left, --top-right, --top-left;
}

/* Top positions */
[data-repere-popover][data-position="top-left"] {
  bottom: anchor(top);
  left: anchor(left);
  position-try-fallbacks: --top-right, --bottom-left, --bottom-right;
}

[data-repere-popover][data-position="top-center"] {
  bottom: anchor(top);
  left: anchor(center);
  translate: -50% 0;
  position-try-fallbacks: --top-left, --top-right, --bottom-center;
}

[data-repere-popover][data-position="top-right"] {
  bottom: anchor(top);
  right: anchor(right);
  position-try-fallbacks: --top-left, --bottom-right, --bottom-left;
}

/* Left positions */
[data-repere-popover][data-position="left-center"]:popover-open {
  top: anchor(center);
  right: anchor(left);
  translate: 0 -50%;
  position-try-fallbacks: --right-center, --bottom-center, --top-center;
}

/* Right positions */
[data-repere-popover][data-position="right-center"]:popover-open {
  top: anchor(center);
  left: anchor(right);
  translate: 0 -50%;
  position-try-fallbacks: --left-center, --bottom-center, --top-center;
}

/* Trigger anchor */
[data-repere-trigger] {
  anchor-name: var(--repere-anchor);
}

/* Position try fallbacks */
@position-try --bottom-left {
  top: anchor(bottom);
  left: anchor(left);
  right: auto;
  bottom: auto;
  translate: 0 0;
}

@position-try --bottom-right {
  top: anchor(bottom);
  right: anchor(right);
  left: auto;
  bottom: auto;
  translate: 0 0;
}

@position-try --bottom-center {
  top: anchor(bottom);
  left: anchor(center);
  right: auto;
  bottom: auto;
  translate: -50% 0;
}

@position-try --top-left {
  bottom: anchor(top);
  left: anchor(left);
  right: auto;
  top: auto;
  translate: 0 0;
}

@position-try --top-right {
  bottom: anchor(top);
  right: anchor(right);
  left: auto;
  top: auto;
  translate: 0 0;
}

@position-try --top-center {
  bottom: anchor(top);
  left: anchor(center);
  right: auto;
  top: auto;
  translate: -50% 0;
}

@position-try --left-center {
  top: anchor(center);
  right: anchor(left);
  left: auto;
  bottom: auto;
  translate: 0 -50%;
}

@position-try --right-center {
  top: anchor(center);
  left: anchor(right);
  right: auto;
  bottom: auto;
  translate: 0 -50%;
}
